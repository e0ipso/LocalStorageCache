/*!
 * Local Storage Cache - v1.0.0 - 2014-06-30
 * http://mateu-aguilo-bosch.github.io/LocalStorageCache
 *
 * Local storage wrapper with notification and auto expiration capabilities
 * Licensed GPL-2.0+
 */
(function(){"use strict";function a(a){var b=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return!1}};if(!b())throw new Error("Local storage not supported");this.events=null,"undefined"!=typeof EventEmitter&&(this.events=new EventEmitter),this.prefix=a.prefix||"ls","."!==this.prefix.substr(-1)&&(this.prefix=this.prefix?this.prefix+".":""),this.notify=a.notify||{setItem:!1,removeItem:!1,getItem:!1,listItems:!1}}a.prototype.set=function(a,b){localStorage.setItem(this.prefix+a,b=JSON.stringify(b)),this.notify.setItem&&this.trigger("local-storage-set",{prefix:this.prefix,key:a,value:b})},a.prototype.remove=function(a){localStorage.removeItem(this.prefix+a),this.notify.removeItem&&this.trigger("local-storage-remove",{prefix:this.prefix,key:a})},a.prototype.get=function(a){var b=localStorage.getItem(this.prefix+a);return b=JSON.parse(b),this.notify.getItem&&this.trigger("local-storage-get",{prefix:this.prefix,key:a}),b},a.prototype.list=function(){var a=this.prefix.length,b=[];for(var c in localStorage)c.substr(0,a)===this.prefix&&b.push(c.substr(a));return this.notify.listItems&&this.trigger("local-storage-list",{prefix:this.prefix}),b},a.prototype.clear=function(){for(var a=this.list(),b=0;b<a.length;b++)this.remove(a[b])},a.prototype.trigger=function(a,b){this.events&&("undefined"!=typeof b?this.events.emit(a):this.events.emit(a,[b]))},this.LocalStorageWrapper=a}).call(this),function(){"use strict";function a(a){this.storage=new LocalStorageWrapper(a),this.expiration=a.expiration||{expire:!0,interval:86400}}a.prototype.isExpired=function(a){var b=this.storage.get(a+"__expiration");if(!b)return!1;var c=new Date,d=new Date(parseInt(b,10));return c>d},a.prototype.get=function(a){if(this.expiration.expire){var b=null!==a.match(/__expiration$/);if(!b&&this.isExpired(a))return this.remove(a),null}return this.storage.get(a)},a.prototype.set=function(a,b){var c=null!==a.match(/__expiration$/);if(this.expiration.expire&&!c){var d=new Date,e=new Date(d.getTime()+1e3*this.expiration.interval);this.storage.set(a+"__expiration",e.getTime())}this.storage.set(a,b)},a.prototype.remove=function(a){this.expiration.expire&&this.storage.remove(a+"__expiration"),this.storage.remove(a)},this.LocalStorageCache=a}.call(this);